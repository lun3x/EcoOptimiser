<!DOCTYPE html>
<html>
    <head>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="https://www.w3schools.com/lib/w3.css" rel="stylesheet">
    <script src="lib/jquery-3.1.1.min.js"></script>
    <script src="lib/jquery.csv.js"></script>
    <script src="wind/windPower.js" type="text/javascript"></script>
    <script src="hydro/hydroPower.js" type="text/javascript"></script>
    <script src="tidal/tidePower.js" type="text/javascript"></script>
    <script src="dataReading.js" type="text/javascript"></script>
    <script src="renewableCalc.js" type="text/javascript"></script>
    <style>
      #map {
        height: 100%;
        width: 70%;
      }
      #mapandbest {
        height: 80%;
      }
      #page1 {
        height: 100vh;
      }
      #page2 {
        height: 100vh;
      }
    </style>
        
    <title>EcoOptimiser</title>
        
    </head>
    
    <body>
        <div class="w3-panel" id="page1">
            <div class="w3-panel">
                <h1>EcoOptimiser</h1>
                <h2>Finding the optimal locations for renewable energy</h2>
            </div>
            <div class="w3-cell-row" id="mapandbest">
                <div class="w3-cell w3-panel w3-border" id="map"></div>
                <div class="w3-cell w3-panel w3-border">
                    <h3>Optimal Locations for:</h3>
                    <div class="w3-cell-row">
                        <div class="w3-cell">
                            <button class="w3-button w3-hover-green w3-white w3-border w3-border-green w3-round-large" id="button0" onclick="changeButton(0,'green')">Wind</button>
                        </div>
                        <div class="w3-cell">
                            <div class="w3-cell w3-centre">
                                <button class="w3-button w3-hover-blue w3-white w3-border w3-border-blue w3-round-large" id="button1" onclick="changeButton(1,'blue')">Hydro-Electric</button>
                            </div>
                        </div>
                        <div class="w3-cell">
                            <button class="w3-cell w3-button w3-white w3-hover-grey w3-border w3-border-grey w3-round-large" id="button2" onclick="changeButton(2,'grey')">Tidal</button>
                        </div>
                    </div>
                    <div class="w3-panel" id="enList0" style="display:none">
                        <ul class="w3-ul">
                            <li class="w3-green">
                                <h4>Best Wind Locations</h4>
                            </li>
                            <li class="w3-hover-green" id="windLoc1" onclick="scrollTo('wind',1)"></li>
                            <li class="w3-hover-green" id="windLoc2" onclick="scrollTo('wind',2)"></li>
                            <li class="w3-hover-green" id="windLoc3" onclick="scrollTo('wind',3)"></li>
                        </ul>
                    </div>
                    <div class="w3-panel" id="enList1" style="display:none">
                        <ul class="w3-ul">
                            <li class="w3-blue">
                                <h4>Best Hydro-Electric Locations</h4>
                            </li>
                            <li class="w3-hover-blue" id="hydroLoc1" onclick="scrollTo('hydro',1)"></li>
                            <li class="w3-hover-blue" id="hydroLoc2" onclick="scrollTo('hydro',2)"></li>
                            <li class="w3-hover-blue" id="hydroLoc3" onclick="scrollTo('hydro',3)"></li>
                        </ul>
                    </div>
                    <div class="w3-panel" id="enList2" style="display:none">
                        <ul class="w3-ul">
                            <li class="w3-grey">
                                <h4>Best Tidal Locations</h4>
                            </li>
                            <li class="w3-hover-grey" id="tidalLoc1" onclick="scrollTo('tidal',1)"></li>
                            <li class="w3-hover-grey" id="tidalLoc2" onclick="scrollTo('tidal',2)"></li>
                            <li class="w3-hover-grey" id="tidalLoc3" onclick="scrollTo('tidal',3)"></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="w3-panel" id="page2">
            <a href="info"></a>
            <h1>Information</h1>
            <p id="placetitle">Scilly</p>
            <p id="energytype">Wind</p>
            <p id="potentialenergyyearly">5000kwh</p>
            <p id="estimatedcost">Â£5000000</p>
            <div class="w3-cell w3-panel w3-border" id="satelitepic"></div>
            <p id="constants"></p>
        </div>
        <script>
            var markers = [];
            var buttonStatus = [0,0,0]
            var map;
            var bestWindLocations = [];
            var bestTidalLocations = [];
            var bestHydroLocations = [];
            
            function initMap() {
                //var hydroData = [];
                var uk = {lat: 56.000, lng: -2.5478};
                map = new google.maps.Map(document.getElementById('map'), {
                        zoom: 5,
                        center: uk
                });

                $(document).ready(function() {
                    $.ajax({
                        type: "GET",
                        url: "http://localhost:8000/wind/windData.csv",
                        dataType: "text",
                        success: function(data) {
                            var windData = processData(data);
                            markers[0] = initWindPower(map, windData);
                            setMapOnAll(null,markers[0]);
                            bestWindLocations = getBestWindLocations(windData);
                        }
                    });
                    $.ajax({
                        type: "GET",
                        url: "http://localhost:8000/hydro/hydroData.csv",
                        dataType: "text",
                        success: function(data) {
                            var hydroData = processData(data);
                            markers[1] = initHydroPower(map, hydroData);
                            setMapOnAll(null,markers[1]);
                            bestHydroLocations = getBestHydroLocations(hydroData);
                        }
                    });
                    $.ajax({
                        type: "GET",
                        url: "http://localhost:8000/tidal/tideData.csv",
                        dataType: "text",
                        success: function(data) {
                            var tideData = processData(data);
                            markers[2] = initTidalPower(map, tideData);
                            setMapOnAll(null,markers[2]);
                            bestTidalLocations = getBestTidalLocations(tideData);
                        }
                    });
                });
            }

            function changeFocus(){
                document.getElementById("page2").focus();
            }

            function changeButton(num, colour){
                if (buttonStatus[num] == 0) {
                    document.getElementById("button"+parseInt(num)).className = "w3-button w3-hover-"+colour+" w3-"+colour+" w3-border w3-border-"+colour+" w3-round-large"
                    document.getElementById("enList"+parseInt(num)).style.display = "block";
                    setMapOnAll(map,markers[num]);
                }

                else {
                    document.getElementById("button"+parseInt(num)).className = "w3-button w3-hover-"+colour+" w3-white w3-border w3-border- "+colour+" w3-round-large"
                    document.getElementById("enList"+parseInt(num)).style.display = "none";
                    setMapOnAll(null,markers[num]);
                }

                buttonStatus[num] = 1 - buttonStatus[num];
            }

            function setMapOnAll(map, markers) {
                for (var i = 0; i < markers.length; i++) {
                    markers[i].setMap(map);
                }
            }

            function scrollTo(enType, enNum){
                $('html, body').animate({
                        scrollTop: $("#page2").offset().top
                }, 750);

                var placeName = document.getElementById(enType + "Loc" + enNum).innerHTML;
                var enData;
                
                switch (enType) {
                    case "wind":
                        enData = bestWindLocations[enNum - 1]; // Take away 1 to get array value
                        break;
                    case "tidal":
                        enData = bestTidalLocations[enNum - 1]; // Take away 1 to get array value
                        break;
                    case "hydro":
                        enData = bestHydroLocations[enNum - 1]; // Take away 1 to get array value
                        break;
                }
            
                fillInInfoPage(placeName, enType, enData);
            }
        </script>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCS7yxaTkdNhukqXo0vFKA4nZfq_ZTip4k&callback=initMap"></script>
    </body>
</html>